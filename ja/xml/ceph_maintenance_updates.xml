<?xml version="1.0" encoding="UTF-8"?>
<appendix xmlns="http://docbook.org/ns/docbook" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:base="ceph_maintenance_updates.xml" version="5.0">
 <title>アップストリーム「Nautilus」ポイントリリースに基づくCeph保守更新</title>
 <info>
  <dm:docmanager xmlns:dm="urn:x-suse:ns:docmanager">
   <dm:editurl>https://github.com/SUSE/doc-ses/edit/master/xml/</dm:editurl>
   <dm:maintainer>tbazant@suse.com</dm:maintainer>
   <dm:status>編集</dm:status>
   <dm:deadline/>
   <dm:priority/>
   <dm:translation>yes</dm:translation>
   <dm:languages/>
   <dm:release>SES 6</dm:release>
  </dm:docmanager>
 </info>
 <para>
  SUSE Enterprise Storage 6のいくつかの主要パッケージは、CephのNautilusリリースシリーズに基づいています。Cephプロジェクト(<link xlink:href="https://github.com/ceph/ceph"/>)がNautilusシリーズの新しいポイントリリースを公開した場合、SUSE Enterprise Storage 6は、アップストリームの最新のバグ修正や機能のバックポートのメリットを得られるように更新されます。
 </para>
 <para>
  この章には、製品に組み込み済みか、組み込みが予定されている各アップストリームポイントリリースに含まれる重要な変更点についての概要が記載されています。
 </para>
 <bridgehead renderas="sect1">Nautilus 14.2.4ポイントリリース</bridgehead>
 <para>
  このポイントリリースでは、14.2.3ポイントリリースで見つかった重大なリグレッションが修正されます。SUSEは14.2.3に基づくバージョンを出荷していないため、このバグはSUSE Enterprise Storageのお客様には影響しませんでした。
 </para>
 <bridgehead renderas="sect1">Nautilus 14.2.3ポイントリリース</bridgehead>
 <itemizedlist>
  <listitem>
   <para>
    サービス拒否の脆弱性により、認証されていないCeph Object Gatewayクライアントが、キャッチされない例外によるクラッシュをトリガする可能性がありました。この脆弱性を修正しました。
   </para>
  </listitem>
  <listitem>
   <para>
    NautilusベースのlibrbdクライアントでJewelクラスタ上のイメージを開くことができるようになりました。
   </para>
  </listitem>
  <listitem>
   <para>
    Object Gateway <option>num_rados_handles</option>が削除されました。1より大きい<option>num_rados_handles</option>の値を使用している場合に、同じ調整動作を実現するには、現在の<option>objecter_inflight_ops</option>パラメータと<option>objecter_inflight_op_bytes</option>パラメータに古い<option>num_rados_handles</option>を掛けます。
   </para>
  </listitem>
  <listitem>
   <para>
    このリリースにより、Messenger v2プロトコルのセキュアモードは実験用ではなくなりました。このモードは、モニター接続の優先モードになりました。
   </para>
  </listitem>
  <listitem>
   <para>
    <option>osd_deep_scrub_large_omap_object_key_threshold</option>の値を下げ、大量のomapキーが含まれるオブジェクトをより簡単に検出できるようにしました。
   </para>
  </listitem>
  <listitem>
   <para>
    CephダッシュボードがPrometheus通知の無音化をサポートしました。
   </para>
  </listitem>
 </itemizedlist>
 <bridgehead renderas="sect1">Nautilus 14.2.2ポイントリリース</bridgehead>
 <itemizedlist>
  <listitem>
   <para>
    <literal>no{up,down,in,out}</literal>関連のコマンドが刷新されました。<literal>no{up,down,in,out}</literal>フラグを設定する方法は2つあります。古いコマンドは次のとおりです。
   </para>
<screen>ceph osd [un]set <replaceable>FLAG</replaceable></screen>
   <para>
    これは、クラスタ全体にフラグを設定します。新しいコマンドは次のとおりです。
   </para>
<screen>ceph osd [un]set-group <replaceable>FLAGS</replaceable> <replaceable>WHO</replaceable></screen>
   <para>
    これは、クラッシュノードまたはデバイスクラスの粒度でバッチでフラグを設定します。
   </para>
  </listitem>
  <listitem>
   <para>
    古いバージョンのObject Gatewayでは、バケットのリシャーディング後に、期限切れの古いオブジェクトが残ることがありました。<command>radosgw-admin</command>に、このようなオブジェクトを管理できるサブコマンドが2つ導入されました。一方のサブコマンドは、このようなオブジェクトを一覧にし、他方のサブコマンドはこれらを削除します。
   </para>
  </listitem>
  <listitem>
   <para>
    以前のNautilusリリース(14.2.1および14.2.0)には、アップグレードされたクラスタ(元々、Nautilus以前に導入されたクラスタ)に単一の新しいNautilus BlueStore OSDを導入すると、<command>ceph df</command>によってレポートされるプール使用率統計情報が壊れるという問題がありました。すべてのOSDを再プロビジョニングまたは更新するまで(<command>ceph-bluestore-tool repair</command>を使用)、プール統計情報には、実際の値より小さい値が表示されます。これが14.2.2で解決され、クラスタはより正確なプールごとの統計を使用するように切り替わります。ただし、<emphasis/>「すべて」のOSDが14.2.2以降であること、ブロックストレージであること、かつNautilusより前に作成されている場合は修復機能を使用して更新されていること、という条件があります。
   </para>
  </listitem>
  <listitem>
   <para>
    <option>mon_crush_min_required_version</option>のデフォルト値が<literal>firefly</literal>から<literal>hammer</literal>に変更されました。つまり、CRUSH調整可能パラメータがHammerより古い場合、クラスタによってヘルス警告が発行されます。一般的には、Hammer調整可能パラメータに切り替わることでリバランスされるデータの量は、わずかです(ただし、ゼロではありません)。
   </para>
   <para>
    可能な場合は、許可されている最も古いクライアントを<literal>hammer</literal>以降に設定することをお勧めします。現在許可されている最も古いクライアントを表示するには、次のコマンドを実行します。
   </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph osd dump | grep min_compat_client</screen>
   <para>
    現在の値が<literal>hammer</literal>より古い場合は、次のコマンドを実行して、現在クラスタに接続しているクライアントの中にHammerより古いものがないことを確認し、この変更を行っても安全かどうかを判断してください。
   </para>
<screen><prompt>cephadm@adm &gt; </prompt>ceph features</screen>
   <para>
    新しい<literal>straw2</literal> CRUSHバケットタイプがHammerに導入されました。すべてのクライアントがHammer以降であることを確認したら、バランサの<literal>crush-compat</literal>モードを含む、<literal>straw2</literal>バケットでのみサポートされる新機能を使用できます(<xref linkend="mgr-modules-balancer"/>)。
   </para>
  </listitem>
 </itemizedlist>
 <para>
  パッチの詳細については、<link xlink:href="https://download.suse.com/Download?buildid=D38A7mekBz4~"/>を参照してください。
 </para>
 <bridgehead renderas="sect1">Nautilus 14.2.1ポイントリリース</bridgehead>
 <para>
  これは、元のNautilusリリース(14.2.0)に続く最初のポイントリリースでした。SUSE Enterprise Storage 6の元の(「一般提供」または「GA」)バージョンは、このポイントリリースに基づいていました。
 </para>
</appendix>
